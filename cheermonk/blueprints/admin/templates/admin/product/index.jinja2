{% extends 'layouts/app.jinja2' %}
{% import 'macros/items.jinja2' as items %}
{% import 'macros/form.jinja2' as f with context %}

{% block title %}Admin - Products / List{% endblock %}

{% block body %}
  {{ f.search('admin.products') }}

  {% if products.total == 0 %}
      <h3>No results found</h3>
    {% if request.args.get('q') %}
        <p>Try limiting or removing your search terms.</p>
    {% else %}
        <p>There are no products present.</p>
    {% endif %}
  {% else %}
      {% call f.form_tag('admin.products_bulk_delete') %}
      <table class="table table-striped">
          <thead>
          <tr>
              <th>
                  <label for="select_all"></label>
                  <input id="select_all" name="select_all" type="checkbox">
              </th>
              <th class="col-header">
                {{ items.sort('created_on', 'Date') }}
              </th>
              <th class="col-header">
                {{ items.sort('business_id') }}
              </th>
              <th class="col-header">
                {{ items.sort('title') }}
              </th>
              <th class="col-header">
                {{ items.sort('price') }}
              </th>
              <th id="bulk_actions" colspan="5">
                  <div class="form-inline">
                    {{ f.field(bulk_form.scope, inline=True) }}
                      <button type="submit"
                              class="btn btn-danger btn-sm">
                          Delete items
                      </button>
                  </div>
              </th>
          </tr>
          </thead>
          <tbody>
          {% for product in products.items %}
              <tr>
                  <td>
                      <label for="bulk_ids"></label>
                      <input class="checkbox-item" id="bulk_ids"
                             name="bulk_ids"
                             type="checkbox" value="{{ product.id }}">
                  </td>
                  <td>
                      <time class="from-now" data-datetime="{{ product.created_on }}">
                        {{ product.created_on }}
                      </time>
                  </td>
                  <td>
                    <a href="{{ url_for('admin.businesses_edit', id=product.business_id) }}">
                        <h5>{{ product.business_id }}</h5>
                    </a>
                  </td>
                  <td>
                      <a href="{{ url_for('admin.products_edit', id=product.id) }}">
                          <h4 class="media-heading">{{ product.title }}</h4>
                      </a>
                  </td>

                  <td>${{ product.price }}</td>
              </tr>
          {% endfor %}
          </tbody>
      </table>
      {% endcall %}

    {{ items.paginate(products) }}
  {% endif %}
{% endblock %}

