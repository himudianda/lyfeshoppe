{% extends 'dashboard/layouts/app.jinja2' %}
{% import 'dashboard/macros/form.jinja2' as f with context %}

{% block title %}
    Account | LyfeShoppe | Social Shop with huge discounts.
{% endblock %}

{% block content %}

    <!-- BEGIN CONTENT -->
    <div class="page-content-wrapper">
        <!-- BEGIN CONTENT BODY -->
        <div class="page-content">
            <div class="row">
                <div class="col-md-12">
                    <!-- BEGIN PROFILE CONTENT -->
                    <div class="profile-content">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="portlet light ">
                                    <div class="portlet-title tabbable-line">
                                        <div class="caption caption-md">
                                            <i class="icon-globe theme-font hide"></i>
                                            <span class="caption-subject font-blue-madison bold uppercase">Profile Account</span>
                                        </div>
                                        <ul class="nav nav-tabs">
                                            <li class="active">
                                                <a href="#tab_1_1" data-toggle="tab">Personal Info</a>
                                            </li>
                                            <li>
                                                <a href="#tab_1_2" data-toggle="tab">Change Password</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="portlet-body">
                                        <div class="tab-content">
                                            <!-- PERSONAL INFO TAB -->
                                            <div class="tab-pane active" id="tab_1_1">

                                                {% set endpoint = 'backend.account_settings' %}
                                                {% set form_kwargs = {} %}
                                                {% call f.form_tag(endpoint, **form_kwargs) %}
                                                <form action="#" class="form-horizontal col-md-offset-1">
                                                    <div class="form-body">
                                                        <h3 class="form-section">Personal Details</h3>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <div class="col-md-9">
                                                                        {% call f.form_group(form.first_name, css_class='sm-margin-bottom') %}
                                                                        {% endcall %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <div class="col-md-9">
                                                                        {% call f.form_group(form.last_name, css_class='sm-margin-bottom') %}
                                                                        {% endcall %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!--/span-->
                                                        </div>
                                                        <!--/row-->
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <div class="col-md-9">
                                                                      {% call f.form_group(form.email, css_class='sm-margin-bottom') %}
                                                                      {% endcall %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!--/span-->
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <div class="col-md-9">
                                                                        {% call f.form_group(form.phone, css_class='sm-margin-bottom') %}
                                                                        {% endcall %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!--/span-->
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <div class="col-md-9">
                                                                        {% call f.form_group(form.gender, css_class='sm-margin-bottom') %}
                                                                        {% endcall %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!--/row-->
                                                        <h3 class="form-section">Address</h3>
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <div class="col-md-9">

                                                                        <label class="control-label"><span class="required"> * </span><strong>Country: </strong></label>
                                                                        <select class="crs-country form-control" data-region-id="one" id="country-select" onchange="countrySelect()"></select>
                                                                        <div style="display: none;">
                                                                            {% call f.form_group(form.country, css_class='sm-margin-bottom') %}
                                                                            {% endcall %}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!--/span-->
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <div class="col-md-9">
                                                                        <label class="control-label"><span class="required"> * </span><strong>State/Province: </strong></label>
                                                                        <select id="one" data-value="shortcode" onchange="stateSelect()" class="form-control"></select>
                                                                        <div style="display: none;">
                                                                            {% call f.form_group(form.state, css_class='sm-margin-bottom') %}
                                                                            {% endcall %}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!--/span-->
                                                        </div>
                                                        <br/>
                                                        <!--/row-->
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <div class="col-md-9">
                                                                      {% call f.form_group(form.city, css_class='sm-margin-bottom') %}
                                                                      {% endcall %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!--/span-->
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <div class="col-md-9">
                                                                        {% call f.form_group(form.zipcode, css_class='sm-margin-bottom') %}
                                                                        {% endcall %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!--/span-->
                                                        </div>
                                                        <!--/row-->
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <div class="col-md-9">
                                                                      {% call f.form_group(form.metro, css_class='sm-margin-bottom') %}
                                                                      {% endcall %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!--/span-->
                                                        </div>
                                                        <!--/row-->
                                                    </div>

                                                    <div class="form-actions">
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="row">
                                                                    <div class="col-md-offset-6 col-md-12">

                                                                        <div class="row">
                                                                            <div class="col-md-3">
                                                                                <button type="submit" class="btn green">
                                                                                  {{ _('Save') }}
                                                                                </button>
                                                                            </div>
                                                                            <div class="col-md-3">
                                                                                <div class="visible-xs visible-sm sm-margin-top"></div>
                                                                                <a href="{{ url_for('backend.user_account') }}"
                                                                                   class="btn red btn-block">
                                                                                  {{ _('Cancel') }}
                                                                                </a>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6"> </div>
                                                        </div>
                                                    </div>
                                                </form>
                                                {% endcall %}

                                            </div>
                                            <!-- END PERSONAL INFO TAB -->
                                            <!-- CHANGE PASSWORD TAB -->
                                            <div class="tab-pane" id="tab_1_2">
                                                {% set endpoint = 'backend.account_settings' %}
                                                {% set form_kwargs = {} %}
                                                {% call f.form_tag(endpoint, **form_kwargs) %}
                                                <form action="#">
                                                    <div class="form-group">
                                                        {% call f.form_group(password_reset_form.password, css_class='sm-margin-bottom') %}
                                                        {% endcall %}
                                                    </div>
                                                    <div class="margin-top-10">
                                                        <div class="row">
                                                            <div class="col-md-3">
                                                                <button type="submit" class="btn green">
                                                                  {{ _('Save') }}
                                                                </button>
                                                            </div>
                                                            <div class="col-md-3">
                                                                <div class="visible-xs visible-sm sm-margin-top"></div>
                                                                <a href="{{ url_for('backend.user_account') }}"
                                                                   class="btn red btn-block">
                                                                  {{ _('Cancel') }}
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                                {% endcall %}
                                            </div>
                                            <!-- END CHANGE PASSWORD TAB -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- END PROFILE CONTENT -->
                </div>
            </div>
        </div>
        <!-- END CONTENT BODY -->
    </div>
    <!-- END CONTENT -->
{% endblock %}


{% block footer_scripts %}
    <script src="{{ url_for('static', filename='common/js/jquery.crs.min.js') }}" type="text/javascript"></script>
    <script src="{{ url_for('static', filename='dashboard/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js') }}" type="text/javascript"></script>

    <script type="text/javascript">
        // The country & states select dropdown must show the values thats currently set
        var country_val = $('#country').val();
        var state_val = $('#state').val();
        document.getElementById("country-select").setAttribute("data-default-value", country_val);
        document.getElementById("one").setAttribute("data-default-value", state_val);

        // These functions are triggered when the country or state dropdown changes
        function countrySelect() {
            $('#country').val($('#country-select').val());
        }
        function stateSelect() {
            $('#state').val($('#one').val());
        }

        // Input mask for phone number implemented
        $("#phone").inputmask("mask", {
            "mask": "+999(9999999999)"
        });

    </script>
{% endblock %}
