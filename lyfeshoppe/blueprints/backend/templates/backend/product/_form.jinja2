{% import 'dashboard/macros/form.jinja2' as f with context %}

{% if request.endpoint.endswith('new') %}
  {% set endpoint = 'backend.business_products_new' %}
  {% set form_kwargs = {'username': business.username} %}
  {% set legend = 'Add a new Product' %}
  {% set button = _('Add') %}
{% else %}
  {% set endpoint = 'backend.business_product_edit' %}
  {% set form_kwargs = {'username': business.username, 'product_id': product.id} %}
  {% set legend = 'Update this product' %}
  {% set button = _('Save') %}
{% endif %}

{% call f.form_tag(endpoint, **form_kwargs) %}
<div class="portlet box green">
    <div class="portlet-title">
        <div class="caption">
            <i class="fa fa-plus"></i> {{ legend }} 
        </div>
    </div>
    <div class="portlet-body form">
        <!-- BEGIN FORM-->
        <form action="#" class="form-horizontal">

            <div class="form-body">
                <h3 class="form-section">Product Text</h3>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="col-md-9">
                                {% call f.form_group(form.name, css_class='sm-margin-bottom') %}
                                {% endcall %}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="col-md-9">
                                {% call f.form_group(form.category, css_class='sm-margin-bottom') %}
                                {% endcall %}
                            </div>
                        </div>
                    </div>
                    <!--/span-->
                </div>
                <!--/row-->
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <div class="col-md-12">
                              {% call f.form_group(form.description, css_class='sm-margin-bottom', rows=10, cols=2000) %}
                              {% endcall %}
                            </div>
                        </div>
                    </div>
                    <!--/span-->
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="col-md-9">
                                {% call f.form_group(form.active, checked=True, css_class='sm-margin-bottom') %}
                                {% endcall %}
                            </div>
                        </div>
                    </div>
                    <!--/span-->
                </div>
                <h3 class="form-section">More Product Info</h3>
                <!--/row-->
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="col-md-9">
                              {% call f.form_group(form.capacity, css_class='sm-margin-bottom') %}
                              {% endcall %}
                            </div>
                        </div>
                    </div>
                    <!--/span-->
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="col-md-9">
                                {% call f.form_group(form.duration_mins, css_class='sm-margin-bottom') %}
                                {% endcall %}
                            </div>
                        </div>
                    </div>
                    <!--/span-->
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="col-md-9">
                                {% call f.form_group(form.price_cents, css_class='sm-margin-bottom') %}
                                {% endcall %}
                            </div>
                        </div>
                    </div>
                    <!--/span-->
                </div>
                <!--/row-->
            </div>

            <div class="form-actions">
                <div class="row">
                    <div class="col-md-6">
                        <div class="row">
                            <div class="col-md-offset-6 col-md-12">

                                <div class="row">
                                    <div class="col-md-3">
                                        <button type="submit" class="btn green">
                                          {{ button }}
                                        </button>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="visible-xs visible-sm sm-margin-top"></div>
                                        <a href="{{ url_for('backend.business_products', **form_kwargs) }}"
                                           class="btn red btn-block">
                                          {{ _('Cancel') }}
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6"> </div>
                </div>
            </div>


        </form>
        <!-- END FORM-->
    </div>
</div>
{% endcall %}